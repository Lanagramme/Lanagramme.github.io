(()=>{"use strict";var e=console.log;class t{constructor(e,t,i){this.id=this.uuidv4(),this.equipe=e,this.couleur=t,this.plateau=i,this.pv_max=10,this._pv=this.pv_max}get pv(){return this._pv}set pv(e){this._pv=e,$(`#pv-${this.id}`).html(this.pv),!this.pv>0&&$("#"+this.id).fadeOut(600,(function(){$(this).remove()}))}get html(){return`<div class='pion animate__animated ${this.couleur}' id='${this.id}'></div>`}uuidv4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}spawn(){let e;do{e=this.plateau.coordonnees_aleatoires()}while(""!=$(this.plateau.coordonnees_to_querySelector(e)).html());$(this.plateau.coordonnees_to_querySelector(e)).append(this.html),this.define_position(e)}move(e){let t=this.plateau.coordonnees_to_querySelector(e);""==$(t).html()&&($(this.plateau.coordonnees_to_querySelector(this.coord)).html(""),$(t).append(this.html)),this.define_position(e)}define_position(e){this.coord={x:e.x,y:e.y}}}class i{constructor(e,t){this.nom=e,this.couleur=t}}console.log;var o=["Acid_Apple","Acid_Pain","Acid_Rain","Acid_Sky","Acid_Voice","Bad_Apple","Bad_Book","Bad_Actor","Black_Book","Black_Pain","Blue_Apple","Blue_Lullaby","Blue_Rain","Breaking_Glass","Breaking_Ground","Breaking_Point","Broken_Chains","Broken_Glass","Broken_Lullaby","Broken_Melody","Broken_Shield","Broken_Sky","Broken_Thread","Broken_Void","Crazy_Apple","Electric_Apple","Electric_Blue","Electric_Box","Electric_Chain","Electric_City","Electric_Cube","Electric_Doll","Electric_Dream","Electric_Epic","Electric_Feel","Electric_Fire","Electric_Light","Electric_Lullaby","Electric_Machine","Electric_Man","Electric_Message","Electric_Pain","Electric_Point","Electric_Rain","Electric_Red","Electric_Sheep","Electric_Shock","Electric_Sky","Electric_Sleep","Electric_Snow","Electric_Sound","Electric_Star","Electric_Voice","Electric_Voice","Electric_Void","Electric_Wall","Electric_Wire","Empty_Voice","Empty_Void","Fantom_Freaks","Fantom_Pain","Fantom_Rain","Frontier_Freaks","Frozen_Apple","Frozen_Chains","Frozen_Glass","Frozen_Ground","Frozen_Pain","Frozen_Point","Frozen_Rain","Frozen_Shield","Frozen_Sky","Frozen_Void","Glass_Chains","Glass_Shield","Glass_Sky","Glass_Wall","Icy_Sky","Iron_Chains","Iron_Shield","Iron_Sky","Iron_Thread","Liquid_Pain","Liquid_Sky","Liquid_Void","Phantom_Thread","Phantom_Void","Royal_Guard","Solid_Glass","Solid_Ground","Solid_Pain","Solid_Rain","Solid_Void","Stolen_Book","Void_Dream","Void_Sky","Void_Voice"];function r(e){return Math.floor(Math.random()*Math.floor(e))}function s(e,i){let o=[];$(".panel .teams").html("");for(let r in i){$(".panel .teams").append(`<div id="${i[r].nom}" class="p-2"></div>`),$(`#${i[r].nom}`).append(`\n\t\t\t<h2>${i[r].nom}</h2>\n\t\t`);for(let s=e;s>0;s--)o.push(new t(i[r].nom,i[r].couleur))}return o}function a(){let e=[];e[0]=r(6);do{e[1]=r(6)}while(e[0]==e[1]);return e}let n=a(),l={equipe1:new i(o[r(o.length)],"lin-"+n[0]),equipe2:new i(o[r(o.length)],"lin-"+n[1])},c=s(3,l),_=new class{constructor(e,t,i){this.ligne_max=e,this.colone_max=t,this.pion_actif=null,this.case_movement=[],this.case_portee=[],this.pions=i}coordonnees_to_querySelector(e){return`.x${e.x}.y${e.y}`}coordonnees_from_classes(e){return{x:Number(e[1].split("x")[1]),y:Number(e[2].split("y")[1])}}reset_damier(e,t){this.ligne_max=e,this.colone_max=t,this.dessin_damier(),this.spawn(),this.case_event()}dessin_damier(){$("#grille").html("");for(let e=0;e<this.ligne_max;e++){$("#grille").append(`<div class="ligne_${e}"></div>`);for(let t=0;t<this.colone_max;t++)$(".ligne_"+e).append(`<div class="case x${t} y${e}"></div>`)}}coordonnees_aleatoires(){return{x:this._RNG(this.colone_max-1)+1,y:this._RNG(this.ligne_max-1)+1}}_RNG(e){return Math.floor(Math.random()*Math.floor(e))}spawn(){let e;for(let t of this.pions){do{e=this.coordonnees_aleatoires()}while(""!=$(this.coordonnees_to_querySelector(e)).html());$(this.coordonnees_to_querySelector(e)).append(t.html),t.define_position(e),$(`#${t.equipe}`).append(`\n\t\t\t\t<div id="info_${t.id}" class="p-1 d-flex">\n\t\t\t\t\t<span class="circle ${t.couleur} mr-2"></span>\n\t\t\t\t\t<span id="coord-${t.id}">x${t.coord.x} : y${t.coord.y}</span>\n\t\t\t\t\t<span class="ml-2"> [ <span id="pv-${t.id}">${t.pv}</span> / ${t.pv_max} ]<span/>\n\t\t\t\t</div>\n\t\t\t`)}}move(e,t){let i=this.coordonnees_to_querySelector(t);""==$(i).html()&&($(this.coordonnees_to_querySelector(e.coord)).html(""),$(i).append(e.html),e.define_position(t),$(`#coord-${e.id}`).html(`x${e.coord.x} : y${e.coord.y}`))}get_move_area(e,t){let i=[];i.push(e);for(let e=0;e<t-1;e++)for(let e of i)""==$(this.coordonnees_to_querySelector({x:e.x+1,y:e.y})).html()&&i.push({x:e.x+1,y:e.y}),""==$(this.coordonnees_to_querySelector({x:e.x-1,y:e.y})).html()&&i.push({x:e.x-1,y:e.y}),""==$(this.coordonnees_to_querySelector({x:e.x,y:e.y+1})).html()&&i.push({x:e.x,y:e.y+1}),""==$(this.coordonnees_to_querySelector({x:e.x,y:e.y-1})).html()&&i.push({x:e.x,y:e.y-1}),i=Array.from(new Set(i));return i}get_attack_area(e,t){let i=[];i.push(e);for(let e=0;e<t-1;e++)for(let e of i)i.push({x:e.x+1,y:e.y}),i.push({x:e.x-1,y:e.y}),i.push({x:e.x,y:e.y+1}),i.push({x:e.x,y:e.y-1}),i=Array.from(new Set(i));return i}draw_move_area(){$(".case").removeClass("attack");let e=this.get_move_area(this.coordonnees_from_classes($(".active")[0].classList),3);for(let t of e)$(this.coordonnees_to_querySelector(t)).addClass("movement")}draw_attack_area(){$(".case").removeClass("movement");let e=this.get_attack_area(this.coordonnees_from_classes($(".active")[0].classList),3);for(let t of e)$(this.coordonnees_to_querySelector(t)).addClass("attack")}clear_board_classes(){$(".case").removeClass("active").removeClass("movement").removeClass("attack").removeClass("attack"),$(".pion").removeClass("animate__bounce"),$('*[id^="info_"]').removeClass("red"),this.pion_actif=null}case_event(){$(".case").click((t=>{Array.from(t.target.classList).includes("case")||(t.target=t.target.parentNode),null==this.pion_actif&&t.target.children.length?(this.clear_board_classes(),e(t.target.children[0].id),this.pion_actif=this.pions.find((e=>e.id==t.target.children[0].id)),$(this.coordonnees_to_querySelector(this.pion_actif.coord)).addClass("active")):null!=this.pion_actif&&t.target.children.length&&Array.from(t.target.classList).includes("attack")?(this.clear_board_classes(),t.target.children[0].classList.add("animate__bounce"),e(t.target.children[0].id),this.pions.find((e=>e.id==t.target.children[0].id)).pv-=5):null!=this.pion_actif&&t.target.children.length&&!Array.from(t.target.classList).includes("attack")?(this.clear_board_classes(),this.pion_actif=this.pions.find((e=>e.id==t.target.children[0].id)),$(this.coordonnees_to_querySelector(this.pion_actif.coord)).addClass("active")):null!=this.pion_actif&&Array.from(t.target.classList).includes("movement")?(this.move(this.pion_actif,{x:Number(Array.from(t.target.classList)[1].split("x")[1]),y:Number(Array.from(t.target.classList)[2].split("y")[1])}),this.clear_board_classes()):this.clear_board_classes(),$('*[id^="info_"]').removeClass("red"),null!=this.pion_actif&&(console.log({id:this.pion_actif.id,coord:this.pion_actif.coord}),$(`#info_${this.pion_actif.id}`).addClass("red"))}))}}(5,5,c);$("form").submit((function(e){e.preventDefault(),n=a(),l={equipe1:new i(o[r(o.length)],"lin-"+n[0]),equipe2:new i(o[r(o.length)],"lin-"+n[1])},_.pions=s(3,l),_.reset_damier($("#compte_ligne").val(),$("#compte_colone").val()),$(".all").hide()})),_.dessin_damier(),_.spawn(),_.case_event(),$(".deplacement").click((()=>{null!=_.pion_actif&&$(".active")&&_.draw_move_area()})),$(".attack").click((()=>{null!=_.pion_actif&&$(".active")&&_.draw_attack_area()})),$(".clearBoard").click((()=>{_.clear_board_classes()}))})();